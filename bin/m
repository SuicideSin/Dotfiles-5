#!/usr/bin/env python
USAGE = """usage: %prog EXPRESSION
       %prog -i

`m` performs quick math calculations by evaluating its command-line
argments as a single python expression. It also helpfully imports
everything from `math` so you can easily preform complex calculations."""

# TODO: replace all python with 2.7 so we can use argparse
from optparse import OptionParser

import code
from math import *

def parse_args():
    """Retrieve the command-line options"""
    parser = OptionParser(usage=USAGE)
    parser.add_option("-i", "--interactive", default=False,
            action="store_true",
            help="Enter an interactive interpreter")
    return (parser.parse_args()) + (parser,)

def main():
    options, args, parser = parse_args()

    if not options.interactive and len(args) == 0:
        parser.error("You must supply an expression")

    if options.interactive:
        # enter a python prompt
        code.InteractiveConsole(locals=globals()).interact()
        return

    # evaluate and print
    print eval(" ".join(args))

if __name__ == "__main__":
    main()
